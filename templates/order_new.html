{% extends "base.html" %}
{% block title %}New Order for Table {{ table.table_number }}{% endblock %}

{% block content %}
<h2>Start New Order - Table {{ table.table_number }}</h2>
<p>Capacity: {{ table.capacity }} | Current Status: {{ table.status|capitalize }}</p>
<hr>

{% if table.status != 'available' %}
<div class="alert alert-warning">Cannot start a new order. Table status is not 'available'.</div>
<a href="{{ url_for('tables_manage') }}" class="btn btn-secondary">Back to Tables</a>
{% else %}

<form action="{{ url_for('order_new', table_id=table._id) }}" method="POST">
    <div class="card mb-4">
        <div class="card-header">Select Initial Items (Optional)</div>
        <div class="card-body">
            {% if menu_items %}
                <div class="row row-cols-1 row-cols-md-2 g-3">
                    {% for item in menu_items %}
                    <div class="col">
                        <div class="input-group input-group-sm mb-2">
                           <span class="input-group-text" style="width: 60%;">{{ item.name }} (${{ "%.2f"|format(item.price) }})</span>
                           <input type="number" class="form-control form-control-sm" name="item_{{ item._id }}" value="0" min="0" placeholder="Qty">
                           <input type="hidden" name="item_id" value="{{ item._id }}"> <!-- Helps identify which items were potentially selected -->
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <p class="text-muted small mt-2">Enter quantity for items to add initially. Leave as 0 to skip.</p>
            {% else %}
                <p class="text-muted">No menu items available to add.</p>
            {% endif %}
        </div>
    </div>

    <button type="submit" class="btn btn-success btn-lg">Start Order</button>
    <a href="{{ url_for('tables_manage') }}" class="btn btn-secondary btn-lg">Cancel</a>
</form>

{% endif %} {# End table status check #}

{% endblock %}